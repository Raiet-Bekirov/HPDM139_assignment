
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tutorial/">
      
      
        <link rel="next" href="../design_decisions/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>API reference - Intersectional Fairness Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Intersectional Fairness Toolkit" class="md-header__button md-logo" aria-label="Intersectional Fairness Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Intersectional Fairness Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Intersectional Fairness Toolkit" class="md-nav__button md-logo" aria-label="Intersectional Fairness Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Intersectional Fairness Toolkit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fairnessdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data" class="md-nav__link">
    <span class="md-ellipsis">
      
        data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data--fairnessdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_csv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_features_and_target" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_features_and_target
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_heart_csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_heart_csv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.validate_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_columns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnesspreprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess--fairnesspreprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.SplitData" class="md-nav__link">
    <span class="md-ellipsis">
      
        SplitData
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.add_age_group" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_age_group
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.apply_transforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_transforms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.make_train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_train_test_split
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.map_binary_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        map_binary_column
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.preprocess_tabular" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess_tabular
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessgroups" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups--fairnessgroups" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups.make_eval_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_eval_df
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups.make_intersectional_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_intersectional_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessadapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.adapters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        adapters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters.make_subject_labels_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_subject_labels_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters.unpack_eval_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        unpack_eval_df
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessvisualisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.visualisation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.visualisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        visualisation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plotter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.disparity" class="md-nav__link">
    <span class="md-ellipsis">
      
        disparity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.error_breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        error_breakdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.metrics_bars" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics_bars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.model_tradeoff" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_tradeoff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.threshold_sweep" class="md-nav__link">
    <span class="md-ellipsis">
      
        threshold_sweep
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_decisions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design decisions
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fairnessdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data" class="md-nav__link">
    <span class="md-ellipsis">
      
        data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data--fairnessdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_csv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_features_and_target" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_features_and_target
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.load_heart_csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_heart_csv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.data.validate_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_columns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnesspreprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess--fairnesspreprocess" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.preprocess
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.SplitData" class="md-nav__link">
    <span class="md-ellipsis">
      
        SplitData
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.add_age_group" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_age_group
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.apply_transforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_transforms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.make_train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_train_test_split
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.map_binary_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        map_binary_column
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.preprocess.preprocess_tabular" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess_tabular
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessgroups" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups--fairnessgroups" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups.make_eval_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_eval_df
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.groups.make_intersectional_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_intersectional_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessadapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.adapters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        adapters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters.make_subject_labels_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_subject_labels_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.adapters.unpack_eval_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        unpack_eval_df
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairnessvisualisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        fairness.visualisation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.visualisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        visualisation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plotter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.disparity" class="md-nav__link">
    <span class="md-ellipsis">
      
        disparity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.error_breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        error_breakdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.metrics_bars" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics_bars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.model_tradeoff" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_tradeoff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fairness.visualisation.Plotter.threshold_sweep" class="md-nav__link">
    <span class="md-ellipsis">
      
        threshold_sweep
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API reference</h1>
<h2 id="fairnessdata">fairness.data</h2>


<div class="doc doc-object doc-module">



<a id="fairness.data"></a>
    <div class="doc doc-contents first">

        <h2 id="fairness.data--fairnessdata">fairness.data</h2>
<p>Data loading utilities used by the fairness toolkit.</p>
<p>This module loads tabular datasets into a pandas
DataFrame, while preserving row order and/or indices
so that downstream steps can guarantee alignment between:</p>
<ul>
<li>model predictions (y_pred)</li>
<li>true labels (y_test)</li>
<li>protected attributes used to construct intersectional groups</li>
</ul>
<p>Dataset-specific logic (e.g., mapping target labels, binning ages, cleaning
special missing-value encodings such as '?') should live in small adapter
functions.</p>


<details class="typical-usage" open>
  <summary>Typical usage</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from fairness.data import load_csv, load_features_and_target
df = load_csv("data/heart.csv")
X, y = load_features_and_target(df, target_col="HeartDisease")</p>
</blockquote>
</blockquote>
</blockquote>
</details>









<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="fairness.data.load_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load a CSV file into a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="fairness.data.PathLike">PathLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_col</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column to use as the row index (passed to pandas.read_csv). If None,
pandas uses a default integer index.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>na_values</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional strings to recognise as NA/NaN</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset as a DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file does not exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the loaded object is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.data.load_features_and_target" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_features_and_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">drop_cols</span><span class="o">=</span><span class="p">())</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Split a DataFrame into features X and target y.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full dataset containing both features and target.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_cols</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional columns to drop from X (e.g., derived protected attributes
used only for fairness analysis such as 'age_group').</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(X, y):</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X is a DataFrame of features, y is a Series of labels.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If target_col is not in df, or if resulting X is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.data.load_heart_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_heart_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;HeartDisease&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Load the Heart Disease CSV used in the tutorial.</p>
<p>This is a wrapper around load_csv() </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="fairness.data.PathLike">PathLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to heart.csv.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected target column name (used for validation).</p>
              </div>
            </td>
            <td>
                  <code>&#39;HeartDisease&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loaded dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the expected target column is missing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.data.validate_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">required</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Validate that required columns exist in the DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>required</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column names that must be present.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any required column is missing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="fairnesspreprocess">fairness.preprocess</h2>


<div class="doc doc-object doc-module">



<a id="fairness.preprocess"></a>
    <div class="doc doc-contents first">

        <h2 id="fairness.preprocess--fairnesspreprocess">fairness.preprocess</h2>
<p>Preprocessing utilities for tabular datasets used in fairness analysis.</p>
<p>This module includes:
- feature engineering (e.g., binning age into age_group)
- converting raw tabular data into numeric features suitable for ML
- producing reproducible train/test splits while preserving indices</p>


<details class="design-notes" open>
  <summary>Design notes</summary>
  <ul>
<li>The toolkit is model-agnostic: these functions do not require sklearn pipelines,
  but they produce outputs compatible with sklearn and similar libraries.</li>
<li>Protected attributes may be used for fairness analysis even if they are excluded
  from model training. Derived protected attributes (e.g. age_group) are excluded from model inputs.</li>
</ul>
</details>

<details class="typical-usage" open>
  <summary>Typical usage</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from fairness.data import load_csv
from fairness.preprocess import add_age_group, preprocess_tabular, make_train_test_split
df = load_csv("data/heart.csv")
df = add_age_group(df)
df_model = preprocess_tabular(df)
split = make_train_test_split(df_model, target_col="HeartDisease", drop_cols=("age_group",))</p>
</blockquote>
</blockquote>
</blockquote>
</details>









<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="fairness.preprocess.SplitData" class="doc doc-heading">
            <code>SplitData</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Container for a reproducible train/test split.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="fairness.preprocess.SplitData.X_train, X_test">X_train, X_test</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrices for training and testing.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="fairness.preprocess.SplitData.y_train, y_test">y_train, y_test</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target vectors for training and testing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="fairness.preprocess.add_age_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_age_group</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">age_col</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">new_col</span><span class="o">=</span><span class="s1">&#39;age_group&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="s1">&#39;older&#39;</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add a categorical age-group column derived from a continuous age column.</p>
<p>This is useful for fairness analysis because continuous protected attributes
(like age) create too many groups; binning yields interpretable groups.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>age_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column containing numeric ages.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Age&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the derived categorical column to create.</p>
              </div>
            </td>
            <td>
                  <code>&#39;age_group&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bins</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bin edges passed to pandas.cut.</p>
              </div>
            </td>
            <td>
                  <code>(0, 55, 120)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels assigned to the bins.</p>
              </div>
            </td>
            <td>
                  <code>(&#39;young&#39;, &#39;older&#39;)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Copy of df with the new categorical column added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If age_col is missing or binning produces missing values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.preprocess.apply_transforms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_transforms</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">transforms</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Apply a sequence of DataFrame -&gt; DataFrame transforms in order.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transforms</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Callable">Callable</span>[[<span title="pandas.DataFrame">DataFrame</span>], <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of callables each returning a modified DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformed DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.preprocess.make_train_test_split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">drop_cols</span><span class="o">=</span><span class="p">(),</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a reproducible train/test split for modelling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessed dataset containing features and target.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_cols</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional columns to exclude from X (e.g. derived protected attributes).</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_size</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fraction of rows assigned to the test set.</p>
              </div>
            </td>
            <td>
                  <code>0.3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>42</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stratify</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, stratify split by the target to preserve class balance.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SplitData


  
      dataclass
   (fairness.preprocess.SplitData)" href="#fairness.preprocess.SplitData">SplitData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container holding X_train, X_test, y_train, y_test.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If target_col is missing or df is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.preprocess.map_binary_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">map_binary_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Map values of a binary/categorical column to new values (e.g., 'M'/'F' -&gt; 1/0).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name to map.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mapping</code>
            </td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="object">object</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary defining how to map values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, raise if unmapped values occur. If False, leave unmapped as-is.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Copy of df with mapped column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If strict=True and unmapped values are found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.preprocess.preprocess_tabular" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">preprocess_tabular</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">drop_cols</span><span class="o">=</span><span class="p">(),</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a tabular DataFrame into numeric ML-ready features.</p>
<p>Performs one-hot encoding for categorical columns (object/category)
and leaves numeric columns unchanged.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_cols</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to drop prior to encoding</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>one_hot</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to one-hot encode categorical columns.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_first</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If one_hot=True, drop the first level for each categorical variable to avoid
perfect multicollinearity in logistic regression models.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A numeric DataFrame compatible with scikit-learn.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="fairnessgroups">fairness.groups</h2>


<div class="doc doc-object doc-module">



<a id="fairness.groups"></a>
    <div class="doc doc-contents first">

        <h2 id="fairness.groups--fairnessgroups">fairness.groups</h2>
<p>Minimal utilities for constructing intersectional group labels and producing
an evaluation DataFrame aligned with model predictions and true labels.</p>
<p>Primary output: a tidy DataFrame with columns:
- subject_label  (intersectional group label per individual)
- y_pred         (model prediction)
- y_true         (true label)</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="fairness.groups.make_eval_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_eval_df</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">protected</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">label_col</span><span class="o">=</span><span class="s1">&#39;subject_label&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Build an evaluation DataFrame for group-based metric functions.</p>
<p>The handoff format for metrics such as accuracy_diff:</p>
<pre><code>subject_labels = eval_df[label_col].tolist()
predictions    = eval_df["y_pred"].tolist()
true_statuses  = eval_df["y_true"].tolist()
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_test</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test-set DataFrame in the SAME row order as y_pred and y_true
(typically df.loc[split.X_test.index]).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protected</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protected columns used to define intersectional groups.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model predictions aligned to df_test rows.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True labels aligned to df_test rows.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the intersectional label column.</p>
              </div>
            </td>
            <td>
                  <code>&#39;subject_label&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns: subject_label, y_pred, y_true (index preserved).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.groups.make_intersectional_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_intersectional_labels</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">protected</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">kv_sep</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an intersectional group label for each row of df.</p>
<p>Example:
    Sex=1|age_group=older</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing protected columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protected</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column names to intersect (order defines label format).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatting separators for the label.</p>
              </div>
            </td>
            <td>
                  <code>&#39;|&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kv_sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatting separators for the label.</p>
              </div>
            </td>
            <td>
                  <code>&#39;|&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>missing</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Placeholder for missing values.</p>
              </div>
            </td>
            <td>
                  <code>&#39;NA&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One label per row, aligned with df.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="fairnessmetrics">fairness.metrics</h2>


<div class="doc doc-object doc-module">



<a id="fairness.metrics"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="fairnessadapters">fairness.adapters</h2>


<div class="doc doc-object doc-module">



<a id="fairness.adapters"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="fairness.adapters.make_subject_labels_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_subject_labels_dict</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">protected_cols</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Build the dict-of-lists format expected by intersect_* functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_test</code>
            </td>
            <td>
                  <code><span title="pd.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test-set DataFrame containing the protected columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protected_cols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>E.g. ["Sex", "age_group"]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>{col: list_of_values_aligned_rowwise_with_eval_df}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="fairness.adapters.unpack_eval_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unpack_eval_df</span><span class="p">(</span><span class="n">eval_df</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert eval_df into the list inputs expected by group_* metric functions.</p>
<p>Expects eval_df columns:
  - subject_label (str)
  - y_pred (0/1)
  - y_true (0/1)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>subject_labels</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>true_statuses</code></td>            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="fairnessvisualisation">fairness.visualisation</h2>


<div class="doc doc-object doc-module">



<a id="fairness.visualisation"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="fairness.visualisation.Plotter" class="doc doc-heading">
            <code>Plotter</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">



        <p>Visualization-only plotter.</p>
<p>Expects (imaginary) precomputed outputs:
  - by_group_df: MultiIndex (feature, group), columns ['n', metrics...]
  - confusion_df: MultiIndex (feature, group), columns ['tp','tn','fp','fn'] (optional)
  - threshold_df: MultiIndex (feature, group, threshold), columns [metrics...] (optional)
  - models_df: columns ['model', perf_metric, fairness_metric] (optional)</p>











<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="fairness.visualisation.Plotter.disparity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">disparity</span><span class="p">(</span><span class="n">by_group_df</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">ref_group</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Disparity plot vs reference group:
  - mode='ratio' : metric(group) / metric(ref)
  - mode='diff'  : metric(group) - metric(ref)</p>
<p>epsilon:
  - if mode='ratio' and epsilon is not None, draws lines at [epsilon, 1/epsilon]
  - if mode='diff', draws line at 0</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fairness.visualisation.Plotter.error_breakdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">error_breakdown</span><span class="p">(</span><span class="n">confusion_df</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stacked bars by group:
  - FP and FN are the most common error breakdown
normalize=True:
  - plots rates: fp/(fp+tn) and fn/(fn+tp) are NOT directly comparable,
    so instead we show fp and fn as shares of total errors (fp+fn).
normalize=False:
  - plots raw counts fp and fn stacked.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fairness.visualisation.Plotter.metrics_bars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">metrics_bars</span><span class="p">(</span><span class="n">by_group_df</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_groups</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Bar chart: for one sensitive feature, plot selected metrics across groups
as small multiples (one subplot per metric).</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fairness.visualisation.Plotter.model_tradeoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model_tradeoff</span><span class="p">(</span><span class="n">models_df</span><span class="p">,</span> <span class="n">perf_metric</span><span class="p">,</span> <span class="n">fairness_metric</span><span class="p">,</span> <span class="n">label_col</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scatter plot: performance vs fairness/disparity for multiple models.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fairness.visualisation.Plotter.threshold_sweep" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">threshold_sweep</span><span class="p">(</span><span class="n">threshold_df</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Line plot across thresholds for a single (feature, group).
Expects index: (feature, group, threshold).</p>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>